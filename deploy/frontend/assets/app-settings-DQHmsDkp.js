import{j as a,w as J,R as l}from"./chunk-NL6KNZEE-aMulfElY.js";import{u as Q}from"./use-save-settings-Ept-aF2B.js";import{u as W,D as Z}from"./use-settings-Bsb8Zd3z.js";import{A as d}from"./index-BKqui9cp.js";import{B as ee}from"./brand-button-CyoWaFBZ.js";import{S as G,a as A}from"./switch-skeleton-CgW30AGB.js";import{S as te}from"./settings-input-DywAD7rj.js";import{I as o}from"./declaration-DTN74MXe.js";import{S as ae}from"./settings-dropdown-input-CmgzkTwP.js";import{u as y}from"./useTranslation-bTmhRewG.js";import{h as se}from"./handle-capture-consent-T7BcghmU.js";import{a as ne,d as oe}from"./custom-toast-handlers-zsVC4dT7.js";import{r as ie}from"./retrieve-axios-error-message-CoJTAmT2.js";import{I as re}from"./input-skeleton-BW1CxBOk.js";import{u as ce}from"./use-config-DZtddvT8.js";import{p as L}from"./settings-utils-DdNkVAkN.js";import"./open-hands-axios-BZ-FJWYr.js";import"./module-BG7DSedf.js";import"./open-hands-B3E073cv.js";import"./useQuery-C6Oy5OYj.js";import"./i18next-Bhc83OLH.js";import"./preload-helper-ckwbz45p.js";import"./i18nInstance-DBIXdvxg.js";import"./mutation-DaRitmBy.js";import"./utils-FAyyxFNV.js";import"./optional-tag-jSauglgi.js";import"./chunk-EG3YEEN2-C8jgHZop.js";import"./chunk-OBFX2YGI-PKFa5-VF.js";import"./index-BkEG4wUf.js";import"./index-nrxvMbfg.js";import"./map-provider-D8d2rI4b.js";function le({defaultKey:s,onChange:g,name:i}){const{t:e}=y();return a.jsx(ae,{testId:i,name:i,onInputChange:g,label:e(o.SETTINGS$LANGUAGE),items:d.map(S=>({key:S.value,label:S.label})),defaultSelectedKey:s,isClearable:!1,wrapperClassName:"w-full max-w-[680px]"})}function Se(){return a.jsxs("div",{"data-testid":"app-settings-skeleton",className:"px-11 py-9 flex flex-col gap-6",children:[a.jsx(re,{}),a.jsx(G,{}),a.jsx(G,{})]})}function ue(){var _;const{t:s}=y(),{mutate:g,isPending:i}=Q(),{data:e,isLoading:S}=W(),{data:T}=ce(),[P,N]=l.useState(!1),[B,E]=l.useState(!1),[U,f]=l.useState(!1),[j,I]=l.useState(!1),[k,h]=l.useState(!1),V=t=>{var x,O,b,R,w,v;const n=(x=t.get("language-input"))==null?void 0:x.toString(),p=((O=d.find(({label:m})=>m===n))==null?void 0:O.value)||Z.LANGUAGE,r=((b=t.get("enable-analytics-switch"))==null?void 0:b.toString())==="on",c=((R=t.get("enable-sound-notifications-switch"))==null?void 0:R.toString())==="on",X=((w=t.get("enable-proactive-conversations-switch"))==null?void 0:w.toString())==="on",Y=(v=t.get("max-budget-per-task-input"))==null?void 0:v.toString(),q=L(Y||"");g({LANGUAGE:p,user_consents_to_analytics:r,ENABLE_SOUND_NOTIFICATIONS:c,ENABLE_PROACTIVE_CONVERSATION_STARTERS:X,MAX_BUDGET_PER_TASK:q},{onSuccess:()=>{se(r),oe(s(o.SETTINGS$SAVED))},onError:m=>{const z=ie(m);ne(z||s(o.ERROR$GENERIC))},onSettled:()=>{N(!1),E(!1),f(!1),I(!1),h(!1)}})},H=t=>{var p,r;const n=(p=d.find(({label:c})=>c===t))==null?void 0:p.label,u=(r=d.find(({value:c})=>c===(e==null?void 0:e.LANGUAGE)))==null?void 0:r.label;N(n!==u)},D=t=>{const n=!!(e!=null&&e.USER_CONSENTS_TO_ANALYTICS);E(t!==n)},M=t=>{const n=!!(e!=null&&e.ENABLE_SOUND_NOTIFICATIONS);f(t!==n)},$=t=>{const n=!!(e!=null&&e.ENABLE_PROACTIVE_CONVERSATION_STARTERS);I(t!==n)},K=t=>{const n=L(t),u=e==null?void 0:e.MAX_BUDGET_PER_TASK;h(n!==u)},F=!P&&!B&&!U&&!j&&!k,C=!e||S||i;return a.jsxs("form",{"data-testid":"app-settings-screen",action:V,className:"flex flex-col h-full justify-between",children:[C&&a.jsx(Se,{}),!C&&a.jsxs("div",{className:"p-9 flex flex-col gap-6",children:[a.jsx(le,{name:"language-input",defaultKey:e.LANGUAGE,onChange:H}),a.jsx(A,{testId:"enable-analytics-switch",name:"enable-analytics-switch",defaultIsToggled:!!e.USER_CONSENTS_TO_ANALYTICS,onToggle:D,children:s(o.ANALYTICS$SEND_ANONYMOUS_DATA)}),a.jsx(A,{testId:"enable-sound-notifications-switch",name:"enable-sound-notifications-switch",defaultIsToggled:!!e.ENABLE_SOUND_NOTIFICATIONS,onToggle:M,children:s(o.SETTINGS$SOUND_NOTIFICATIONS)}),(T==null?void 0:T.APP_MODE)==="saas"&&a.jsx(A,{testId:"enable-proactive-conversations-switch",name:"enable-proactive-conversations-switch",defaultIsToggled:!!e.ENABLE_PROACTIVE_CONVERSATION_STARTERS,onToggle:$,children:s(o.SETTINGS$PROACTIVE_CONVERSATION_STARTERS)}),a.jsx(te,{testId:"max-budget-per-task-input",name:"max-budget-per-task-input",type:"number",label:s(o.SETTINGS$MAX_BUDGET_PER_CONVERSATION),defaultValue:((_=e.MAX_BUDGET_PER_TASK)==null?void 0:_.toString())||"",onChange:K,placeholder:s(o.SETTINGS$MAXIMUM_BUDGET_USD),min:1,step:1,className:"w-[680px]"})]}),a.jsx("div",{className:"flex gap-6 p-6 justify-end border-t border-t-tertiary",children:a.jsxs(ee,{testId:"submit-button",variant:"primary",type:"submit",isDisabled:i||F,children:[!i&&s("SETTINGS$SAVE_CHANGES"),i&&s("SETTINGS$SAVING")]})})]})}const $e=J(ue);export{$e as default};
